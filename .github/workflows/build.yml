name: Step 2 - Unpack boot.img using MagiskBoot

on:
  workflow_dispatch:

jobs:
  unpack_boot:
    runs-on: ubuntu-latest

    steps:
    - name: Download working MagiskBoot binary
      run: |
        curl -Lo magiskboot https://github.com/ayyyed/magiskboot-static/releases/download/v25.2/magiskboot
        chmod +x magiskboot
        sudo mv magiskboot /usr/local/bin/

    - name: Download and unzip boot-original.zip
      run: |
        wget -q https://github.com/usama19931993/exynos990-kernel1/releases/download/boot-original/boot-original.zip
        unzip -o boot-original.zip

    - name: Unpack boot.img using MagiskBoot
      run: |
        magiskboot unpack boot.img
        if [ -f kernel ] && [ -f ramdisk.cpio ]; then
          echo "✅ Unpacked boot.img successfully"
        else
          echo "❌ Failed to unpack boot.img"
          ls -l
          exit 1
        fi